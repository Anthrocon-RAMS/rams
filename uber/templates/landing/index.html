{% extends "base.html" %}
{% block title %}{{ c.EVENT_NAME }} Registration{% endblock %}
{% block content %}
    <script type="text/javascript">
    var parseQueryString = function(queryString) {
            var params = {}, temp, i, len, queries = queryString.split('&');
            for (i = 0, len = queries.length; i < len; i++) {
              if(queries[i]) {
                temp = queries[i].split('=');
                params[temp[0]] = temp[1];
              }
            }
            return params;
        };

        var replaceQueryParam = function(queryParam, value) {
            var queryString = window.location.search.substring(1);
            var params = parseQueryString(queryString);
            if (_.has(params, queryParam) || value) {
                if (value) {
                    params[queryParam] = value;
                } else {
                    delete params[queryParam];
                }
                queryString = $.param(params);
            }
            if (queryString) {
                queryString = '?' + queryString;
            }
            return queryString;
        };

        var replaceQueryParamInUrl = function(queryParam, value) {
          try {
              // Replace the query parameter in the web browser's address bar
              if (history && history.replaceState) {
                  var hash = window.location.hash;
                  var queryString = replaceQueryParam(queryParam, value);
                  history.replaceState({}, document.title, window.location.pathname + queryString + hash);
                  return true;
              }
          } catch(ex) {
              // Don't let any errors here disrupt the rest of the app!
              try { console.log(ex); } catch(ex) {}
          }
          return false;
        };
    $(function() {
            $(window).load(function() {
                $(".loader").fadeOut("fast");
            });
            var message = '{{ message or '' }}';
            var error_message = '{{ error_message }}';
            if (error_message.length) {
                $("#message-alert").addClass("alert-danger").show().children('span').html(error_message);
            } else if (message.length) {
                $("#message-alert").addClass("alert-info").show().children('span').html(message);
            };
        }
        )
        </script>
    <div class="card">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="col-xs-12">
                    <h1 class="text-center">{{ c.EVENT_NAME_AND_YEAR }} Registration<br><br></h1>
                    {% if kiosk_mode %}
                    <div class="text-center">
                        <a class="btn btn-success btn-xl" href="../preregistration/form" role="button">Register for {{ c.EVENT_NAME_AND_YEAR }}</a>
                    </div>
                    {% else %}
                    {% if c.ATTENDEE_ACCOUNTS_ENABLED %}
                        {% if logged_in_account %}
                        <div class="text-center">
                            <a class="btn btn-info btn-xl" href="../preregistration/homepage" role="button">Continue to Homepage</a>
                        </div>
                        {% else %}
                        <div class="col-sm-6 col-sm-offset-3">
                            <h2>Log in</h2>
                        </div>
                            {% include 'preregistration/login.html' %}
                        {% endif %}
                            <br><h2 class="text-center">or</h2><br/>
                    {% endif %}
                        <div class="text-center">
                            <div class="btn-group">
                            <a class="btn btn-primary btn-lg" href="../preregistration/form" role="button">
                                {% if c.ATTENDEE_ACCOUNTS_ENABLED and logged_in_account %}Add New Registration{% elif c.ATTENDEE_ACCOUNTS_ENABLED %}Create New Account{% else %}Register for {{ c.EVENT_NAME_AND_YEAR }}{% endif %}
                            </a>
                            {% if c.DEALER_REG_START and c.DEALER_REG_PUBLIC and c.DEALER_REG_OPEN %}
                            <a class="btn btn-success btn-lg" href="../preregistration/dealer_registration" role="button">
                                Register as Dealer
                            </a>
                            {% endif %}
                            </div>
                            <br><br>
                        </div>
                    {% endif %}
                    {% if kiosk_mode %}
                    <p class="text-right">
                        <a class="btn btn-link btn-lg" href="../landing/index?exit_kiosk=True" role="button">
                            Exit Kiosk Mode
                        </a>
                    </p>
                    {% elif c.AT_THE_CON and c.ATTENDEE_ACCOUNTS_ENABLED %}
                    <p class="text-right">
                        <a class="btn btn-link btn-lg" href="../registration/register?kiosk_mode=True" role="button">
                            Enter Kiosk Mode
                        </a>
                    </p>
                    {% endif %}
                    <p class="text-right">
                        <a class="btn btn-link btn-lg" href="../accounts/homepage" role="button">
                            Admin Login
                        </a>
                    </p>
                    <p class="text-right">
                        <a class="btn btn-link btn-lg" href="../staffing/login" role="button">
                            Staff/Volunteer Login
                        </a>
                    </p>
                    <p class="text-right">
                        <a class="btn btn-link btn-lg" href="../preregistration/check_if_preregistered" role="button">
                            Check If Registered
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}