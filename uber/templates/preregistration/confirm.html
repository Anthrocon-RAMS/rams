{% extends "./preregistration/preregbase.html" %}
{% block title %}Confirm Your Details{% endblock %}
{% block backlink %}{% endblock %}
{% block content %}
<div class="masthead">
</div>

<script type="text/javascript">
    $(function(){
        {% if attendee.has_personalized_badge %}
            $(".badge-row").show();
        {% endif %}
        {% if attendee.amount_extra %}
            setTimeout(function(){  // make sure this happens after jQuery.select2
                $.field("amount_extra").find("option").each(function(){
                    if ($(this).val() < {{ attendee.amount_extra }}) {
                        $(this).remove();
                    }
                });
            }, 1);
        {% endif %}
    });

var sponsor_addon = 50;
var super_sponsor_addon = 195;

$(document).ready(function(){
    var sponsor_badge_price = {{ BADGE_PRICE }} + sponsor_addon
    $('#featured1_select').html('<h4 class="list-group-item-heading">Sponsor: $'+sponsor_badge_price+'</h4>{% if BEFORE_FIRST_PRICE_BUMP %}($105 after Jan 1)<br/>{% endif %}<p class="list-group-item-text">Donate extra and get perks on top of an attending membership.</p>');

    var super_sponsor_badge_price = {{ BADGE_PRICE }} + super_sponsor_addon
    $('#featured2_select').html('<h4 class="list-group-item-heading">Super Sponsor: $'+super_sponsor_badge_price+'</h4>{% if BEFORE_FIRST_PRICE_BUMP %}($250 after Jan 1)<br/>{% endif %}<p class="list-group-item-text">The most generous option - get even more great perks!</p>');

    if ($.val('amount_extra') === sponsor_addon) {
        setBadge('Featured1');
        $("#attendee_select").addClass("disabled");
    } else if ($.val('amount_extra') === super_sponsor_addon) {
        setBadge('Featured2');
        $("#attendee_select").addClass("disabled");
        $("#featured1_select").addClass("disabled");
    } else {
        setBadge('Attendee');
    }
})

        function setBadge(badgeType) {
        $(".badge_type_selector").removeClass("active");
        $(".group_fields").addClass("hide");
        if (badgeType == 'Attendee' && !$("#attendee_select").hasClass("disabled")) {
            $("#attendee_select").addClass("active");
            $.field("amount_extra").val('0').trigger("change");
        }
        if (badgeType == 'Featured1' && !$("#featured1_select").hasClass("disabled")) {
            $("#featured1_select").addClass("active");
            $.field("amount_extra").val(sponsor_addon).trigger("change");
        }
        if (badgeType == 'Featured2') {
            $("#featured2_select").addClass("active");
            $.field("amount_extra").val(super_sponsor_addon).trigger("change");
        }
    }
</script>

<div class="panel panel-default">
<form method="post" action="confirm" class="form-horizontal">
{% csrf_token %}
<input type="hidden" name="id" value="{{ attendee.id }}" />
<input type="hidden" name="return_to" value="{{ return_to }}" />
<br/>
    <label for="badge" class="col-sm-2 control-label">Badge
    <br/><br/><span class="popup">{% popup_link "../static_views/badge_descriptions.html" "What's the difference?" %}</span></label>
    <div class="list-group">
    <div class="col-sm-3">
    <a id="attendee_select" onclick="setBadge('Attendee')" class="list-group-item badge_type_selector active">
        <h4 class="list-group-item-heading">Attending: ${{ BADGE_PRICE }}</h4>
        {% if BEFORE_FIRST_PRICE_BUMP %}($55 after Jan 1)<br/>{% endif %}
        <p class="list-group-item-text">Allows access to the convention for its duration.</p>
    </a>
    </div>
    <div class="col-sm-3">
    <a id="featured1_select" onclick="setBadge('Featured1')" class="list-group-item badge_type_selector">
      <h4 class="list-group-item-heading">Sponsor</h4>
      <p class="list-group-item-text">Donate extra and get perks on top of an attending membership.</p>
    </a>
    </div>
    <div class="col-sm-3">
    <a id="featured2_select" onclick="setBadge('Featured2')" class="list-group-item badge_type_selector">
      <h4 class="list-group-item-heading">Super Sponsor</h4>
      <p class="list-group-item-text">The most generous option - get even more great perks!</p>
    </a>
    </div>
  <div class="form-group">
    <label for="email" class="col-sm-2 control-label">Name</label>
    <div class="col-sm-6">
      {{ attendee.full_name }}
    </div>
  </div>
{% include "preregistration/extra.html" %}
{% include "preregistration/age_and_staffing.html" %}
<div class="form-group">
  <label for="email" class="col-sm-2 control-label">Email Address</label>
  <div class="col-sm-6">
    <input type="email" name="email" id="email" value="{{ attendee.email }}" class="form-control" placeholder="Email Address">
  </div>
</div>
{% include "preregistration/address.html" %}
{% include "preregistration/phone_numbers.html" %}
{% if COLLECT_INTERESTS %}
<div class="form-group">
  <label class="col-sm-2 control-label">What interests you?</label>
  <div class="col-sm-10">
    {% checkgroup attendee.interests %}
  </div>
</div>
{% endif %}


<tr>
    <td></td>
    <td> </td>
</tr>

<div class="form-group">
  <div class="col-sm-6 col-sm-offset-2">
    <button type="submit" class="btn btn-primary" id="updateButton">
      {% if attendee.placeholder %}Register{% else %}Update My Info{% endif %}
    </button>
    {% if attendee.is_transferable %}
    <button type="button" class="btn" onClick='location.href="transfer_badge?id={{ attendee.id }}"'>Transfer my Badge</button>
    {% endif %}
  </div>
</div>

{% if attendee. %}
<tr>
    <td></td>
    <td>

    </td>
</tr>
{% endif %}
</table>

</form>
</div>

{% endblock %}
