{% comment %}
Getting a little hacky here with Magstock shirts and amount_extra. When we have more time, integrate
this bettter with the rest of the shirt system.
{% endcomment %}

<script type="text/javascript">
    $(document).ready(function(){
        update_shirt_visibility();

        $("#buy_shirt_chk").change( function(){
            update_shirt_visibility();
            recalculate_amount_extra_owed();
        });

        function recalculate_amount_extra_owed() {
            var checked = $("#buy_shirt_chk").is(':checked');
            var multiplier = checked ? 1 : -1;
            var original_amount = parseInt($("#amount_extra").val());
            var new_amount = original_amount + (multiplier*{{ SHIRT_COST }})
            $("#amount_extra").val(new_amount);
        }

        function update_shirt_visibility() {
            var checked = $("#buy_shirt_chk").is(':checked');
            setVisible(".shirt-row", checked);
        }
    });
</script>

{% if attendee.amount_extra %}
<tr class="extra-row">
{% else %}
<tr>
    <td><b>Shirt:</b></td>
    <td><i>Shirt pre-orders are closed, but you can still buy them on-site.</i></td>
</tr>

<tr class="extra-row" style="display:none">
{% endif %}
    <input type="hidden" name="amount_extra" value="{{ attendee.amount_extra }}" id="amount_extra" />
    <td> <b>I want to buy a shirt (+${{ SHIRT_COST }})</b> </td>
    <td>
        <input type="checkbox" name="buy_shirt" id="buy_shirt_chk" {% if attendee.amount_extra == SHIRT_COST %}checked{% endif %} />
    </td>
</tr>

<tr class="shirt-row extra-row" style="display:none">
    <td> <b>Shirt Size</b> </td>
    <td>
        <select name="shirt">
            {% options PREREG_SHIRT_OPTS attendee.shirt %}
        </select>
    </td>
</tr>

<tr class="shirt-row extra-row" style="display:none">
    <td> <b>Shirt Type</b> </td>
    <td>
        <select name="shirt_color">
            {% options PREREG_SHIRT_COLOR_OPTS attendee.shirt_color %}
        </select>
    </td>
</tr>